<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Reject Bragg Peaks Far from Expected Bragg Index — seasonder_rejectDistantBraggPeakTest • SeaSondeR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reject Bragg Peaks Far from Expected Bragg Index — seasonder_rejectDistantBraggPeakTest"><meta name="description" content="This function evaluates Bragg peaks based on their proximity to expected Bragg index bins.
If the boundaries of a peak are farther from all Bragg indices than the width of the peak itself,
the peak is rejected by returning an empty integer vector."><meta property="og:description" content="This function evaluates Bragg peaks based on their proximity to expected Bragg index bins.
If the boundaries of a peak are farther from all Bragg indices than the width of the peak itself,
the peak is rejected by returning an empty integer vector."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SeaSondeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro.html">SeaSondeR</a></li>
    <li><a class="dropdown-item" href="../articles/SeaSondeAPM.html">APM</a></li>
    <li><a class="dropdown-item" href="../articles/SeaSondeCS.html">Cross-Spectra Files</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GOFUVI/SeaSondeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reject Bragg Peaks Far from Expected Bragg Index</h1>
      <small class="dont-index">Source: <a href="https://github.com/GOFUVI/SeaSondeR/blob/master/R/SeaSondeRCS_FOR.R" class="external-link"><code>R/SeaSondeRCS_FOR.R</code></a></small>
      <div class="d-none name"><code>seasonder_rejectDistantBraggPeakTest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function evaluates Bragg peaks based on their proximity to expected Bragg index bins.
If the boundaries of a peak are farther from all Bragg indices than the width of the peak itself,
the peak is rejected by returning an empty integer vector.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">seasonder_rejectDistantBraggPeakTest</span><span class="op">(</span></span>
<span>  <span class="va">seasonder_cs_obj</span>,</span>
<span>  <span class="va">peak</span>,</span>
<span>  range <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  peak_name <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-seasonder-cs-obj">seasonder_cs_obj<a class="anchor" aria-label="anchor" href="#arg-seasonder-cs-obj"></a></dt>
<dd><p>A <code>SeaSondeRCS</code> object containing the spectral data and Bragg indices.</p></dd>


<dt id="arg-peak">peak<a class="anchor" aria-label="anchor" href="#arg-peak"></a></dt>
<dd><p>A numeric vector indicating the Doppler bin positions of the peak under evaluation.</p></dd>


<dt id="arg-range">range<a class="anchor" aria-label="anchor" href="#arg-range"></a></dt>
<dd><p>Optional; A numeric or integer value representing the range cell corresponding to the peak.
Defaults to <code>NA</code>.</p></dd>


<dt id="arg-peak-name">peak_name<a class="anchor" aria-label="anchor" href="#arg-peak-name"></a></dt>
<dd><p>Optional; A character string representing the name or identifier of the peak
(e.g., <code>"positive_FOR"</code> or <code>"negative_FOR"</code>). Defaults to an empty string.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A possibly modified version of the <code>peak</code> argument, where a rejected peak
is returned as <code>integer(0)</code>, indicating that it does not pass the proximity test.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Reason for the Test:</strong>
The test ensures that peaks identified as part of the first-order Bragg region are reasonably close
to the expected Bragg index. Peaks that are distant from the Bragg index are likely caused by
noise, interference, or other sources unrelated to first-order Bragg scatter. These invalid peaks,
if included, can lead to erroneous current velocity vectors and degrade the quality of radar-derived
measurements.</p>
<p>Specifically, the test rejects peaks when:</p><ul><li><p>The distance from the left or right boundary of the peak to the nearest Bragg index exceeds
the width of the peak.</p></li>
<li><p>This condition ensures that peaks with excessively large offsets from the Bragg index are excluded.</p></li>
</ul><p><strong>Steps:</strong></p><ol><li><p>If the peak is empty, the function does nothing.</p></li>
<li><p>Calculates the width of the peak as the difference between its maximum and minimum Doppler bin indices.</p></li>
<li><p>Computes the left and right boundaries of the peak.</p></li>
<li><p>Calculates the distance from each boundary to all Bragg indices.</p></li>
<li><p>Rejects the peak if both boundary distances exceed the peak width.</p></li>
<li><p>Logs the rejection information if applicable.</p></li>
</ol><p>This test is particularly important in scenarios where strong non-Bragg signals, such as those from
ships or other high-intensity noise sources, might otherwise be misclassified as first-order Bragg.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>COS. SpectraPlotterMap 12 User Guide. CODAR Ocean Sensors (COS), Mountain View, CA, USA, 2016.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="seasonder_rejectDistantBragg.html">seasonder_rejectDistantBragg</a></code> for applying this test to all range cells and Bragg regions.</p></li>
<li><p><code><a href="seasonder_getBraggLineBins.html">seasonder_getBraggLineBins</a></code> for retrieving Bragg index bins.</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Evaluate a single peak for rejection</span></span></span>
<span class="r-in"><span><span class="va">peak</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">101</span>, <span class="fl">102</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cs_obj</span> <span class="op">&lt;-</span> <span class="fu">seasonder_rejectDistantBraggPeakTest</span><span class="op">(</span><span class="va">cs_obj</span>, <span class="va">peak</span>, range <span class="op">=</span> <span class="fl">5</span>, peak_name <span class="op">=</span> <span class="st">"positive_FOR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juan Luis Herrera Cortijo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

